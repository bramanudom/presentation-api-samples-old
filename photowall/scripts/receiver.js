(function(){"use strict";var e=function(){this.id,this.state="connected",this.onconnect=null,this.onclose=null,this.onterminate=null,this.onmessage=null,this.messageOrigin_,this.messageSource_};e.prototype.close=function(){"close"!=this.state&&(this.state="closed",this.onclose&&this.onclose(new Event("close",{reason:"closed"})))},e.prototype.terminate=function(){this.state="terminated",window.close()},e.prototype.send=function(e){this.messageSource_.postMessage(e,this.messageOrigin_)};var n=function(){this.connectionList=new Promise(function(n,o){var i=new t,a=!1;window.addEventListener("message",function(t){var o=t.data;switch(o.type){case"NEW_CONNECTION":var s=new e;s.id="",s.messageOrigin_=t.origin,s.messageSource_=t.source,i.connections.push(s),a?i.onconnectionavailable&&i.onconnectionavailable(s):(a=!0,n(i));break;case"APP_MESSAGE":i.connections.forEach(function(e){e.onmessage&&e.onmessage(new MessageEvent("message",{data:o.data}))})}})})},t=function(){this.connections=[],this.onconnectionavailable=null};navigator.presentation.receiver=new n}).call(this);var photowall={};photowall.DEFAULT_SLIDESHOW_DELAY=5e3,photowall.DEFAULT_SLIDESHOW_ANIMATION="fadeIn",photowall.TABINDEX_SELECTOR="paper-button, paper-fab, paper-icon-button",photowall.SlideshowAction={ADD_IMAGE:"addImage",REMOVE_IMAGE:"removeImage",CHANGE_DELAY:"changeDelay",CHANGE_ANIMATION:"changeAnimation"},function(){var e={images:[],delay:photowall.DEFAULT_SLIDESHOW_DELAY,animation:photowall.DEFAULT_SLIDESHOW_ANIMATION,currentImageIndex:0},n=0,t=function(){return n++},o=function(n){r(n,e),n.onmessage=function(n){var t=JSON.parse(n.data);switch(t.action){case photowall.SlideshowAction.ADD_IMAGE:i(t.data);break;case photowall.SlideshowAction.REMOVE_IMAGE:a(t.data);break;case photowall.SlideshowAction.CHANGE_DELAY:s(t.data);break;case photowall.SlideshowAction.CHANGE_ANIMATION:c(t.data)}l(e)}},i=function(n){n.id=t(),e.images.push(n),e.currentImageIndex+2==e.images.length&&m(),1==e.images.length&&d()},a=function(n){return e.images.some(function(t){if(t.id==n){var o=e.images.indexOf(t);return e.images.splice(o,1),o<e.currentImageIndex&&e.currentImageIndex--,o==e.currentImageIndex&&(e.currentImageIndex--,d()),!0}})},s=function(n){e.delay=n,e.currentImageIndex--,d()},c=function(n){e.animation=n},r=function(e,n){"object"==typeof n&&(n=JSON.stringify(n)),e.send(n)},l=function(e){navigator.presentation.receiver.connectionList.then(function(n){n.connections.map(function(n){r(n,e)})})},u=null,d=function(){if(u&&clearTimeout(u),e.currentImageIndex++,e.currentImageIndex>=e.images.length&&(e.currentImageIndex=0),0==e.images.length)document.querySelector("#slideshow").innerHTML="";else{var n=e.images[e.currentImageIndex],t=new Image;t.src=n.url,t.className="animated "+e.animation,t.addEventListener("webkitAnimationEnd",function(){for(;document.querySelector("#slideshow").childNodes.length>1;)document.querySelector("#slideshow").removeChild(document.querySelector("#slideshow").firstChild)}),document.querySelector("#slideshow").appendChild(t),m(),u=setTimeout(d,e.delay)}},m=function(){var n=e.currentImageIndex+1;if(n>=e.images.length&&(n=0),e.images.length>1){var t=e.images[n],o=new Image;o.src=t.url}};navigator.presentation.receiver.connectionList.then(function(e){e.connections.map(function(e){o(e)}),e.onconnectionavailable=function(e){o(e[e.length-1])}})}.call(this);